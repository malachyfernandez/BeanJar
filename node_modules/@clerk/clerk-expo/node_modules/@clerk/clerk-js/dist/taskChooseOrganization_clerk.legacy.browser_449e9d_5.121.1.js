"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([["7814"],{8181:function(a,t,e){e.d(t,{D:()=>s});var o=e(73312),i=e(6654),n=e(25623),r=e(64204),l=e(17703);let s=a=>{let{organization:t,showLoadingSpinner:e,...s}=a;return(0,o.BX)(r.Col,{elementDescriptor:r.descriptors.organizationAvatarUploaderContainer,children:[(0,o.tZ)(r.Text,{variant:"subtitle",sx:a=>({textAlign:"left",marginBottom:a.space.$2}),localizationKey:(0,l.u1)("organizationProfile.start.profileSection.uploadAction__title")}),(0,o.tZ)(i.C,{...s,title:(0,l.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,o.tZ)(n.l,{size:a=>a.sizes.$16,showLoadingSpinner:e,...t})})]})}},57484:function(a,t,e){e.d(t,{AO:()=>o,Sz:()=>i});let o={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},i=(a,t,e)=>{var o;if(void 0===t)return[{data:[a],total_count:1}];let i=(null==t||null==(o=t[t.length-1])?void 0:o.total_count)||1;return t.map(t=>{if(void 0===t)return t;let o=t.data.map(t=>t.id===a.id?{...a}:t);return{...t,data:o,total_count:"negative"===e?i-1:i}})}},7008:function(a,t,e){e.r(t),e.d(t,{TaskChooseOrganization:()=>N}),e(65223);var o=e(73312),i=e(61869),n=e(69144),r=e(11576),l=e(64204),s=e(92418),c=e(2672),d=e(92654),u=e(96352),g=e(54264),h=e(76028),z=e(25135),p=e(41024),v=e(20237),m=e(57484),C=e(86988),y=e(42305),O=e(35973),Z=e(96519),b=e(88870);let k=a=>{var t,e,n;let r=(0,c.useCardState)(),{user:u}=(0,i.aF)(),{ref:g,userMemberships:z,userSuggestions:p,userInvitations:m}=(0,h.H)(),C=(null==z?void 0:z.isLoading)||(null==m?void 0:m.isLoading)||(null==p?void 0:p.isLoading),O=(null==z?void 0:z.hasNextPage)||(null==m?void 0:m.hasNextPage)||(null==p?void 0:p.hasNextPage),Z=null==(t=m.data)?void 0:t.filter(a=>!!a),b=null==(e=p.data)?void 0:e.filter(a=>!!a);return(0,o.BX)(o.HY,{children:[(0,o.BX)(d.h.Root,{showLogo:!0,sx:a=>({padding:"".concat(a.space.$none," ").concat(a.space.$8)}),children:[(0,o.tZ)(d.h.Title,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.title")}),(0,o.tZ)(d.h.Subtitle,{localizationKey:(null==u?void 0:u.createOrganizationEnabled)?(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.subtitle"):(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.subtitle__createOrganizationDisabled")})]}),(0,o.tZ)(s.Z.Alert,{sx:a=>({margin:"".concat(a.space.$none," ").concat(a.space.$8)}),children:r.error}),(0,o.tZ)(l.Col,{elementDescriptor:l.descriptors.main,children:(0,o.tZ)(v.o2,{elementDescriptor:l.descriptors.taskChooseOrganizationPreviewItems,children:(0,o.BX)(y.eX,{role:"menu",children:[(z.count||0)>0&&(null==(n=z.data)?void 0:n.map(a=>(0,o.tZ)(f,{...a},a.id))),!z.hasNextPage&&(null==Z?void 0:Z.map(a=>(0,o.tZ)(_,{...a},a.id))),!z.hasNextPage&&!m.hasNextPage&&(null==b?void 0:b.map(a=>(0,o.tZ)(w,{...a},a.id))),(O||C)&&(0,o.tZ)(v.pr,{ref:g}),(0,o.tZ)(S,{onCreateOrganizationClick:()=>{r.setError(void 0),a.onCreateOrganizationClick()}})]})})})]})},f=a=>{let{user:t}=(0,i.aF)(),e=(0,c.useCardState)(),{navigateOnSetActive:n}=(0,C.G)(),{redirectUrlComplete:r}=(0,C._)(),{isLoaded:s,setActive:d}=(0,i.eW)(),{t:u}=(0,l.useLocalizations)();return s?(0,o.tZ)(v.Td,{elementDescriptor:l.descriptors.taskChooseOrganizationPreviewButton,onClick:()=>{let o;return o=a.organization,e.runAsync(async()=>{try{await d({organization:o,navigate:async a=>{let{session:t}=a;await (null==n?void 0:n({session:t,redirectUrlComplete:r}))}})}catch(o){var a,i;if(!(0,p.kD)(o))return void(0,b.S3)(o,[],e.setError);switch(null==(i=o.errors)||null==(a=i[0])?void 0:a.code){case"organization_not_found_or_unauthorized":case"not_a_member_in_organization":(null==t?void 0:t.createOrganizationEnabled)?e.setError(u((0,l.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized"))):e.setError(u((0,l.localizationKeys)("unstable__errors.organization_not_found_or_unauthorized_with_create_organization_disabled")));break;default:(0,b.S3)(o,[],e.setError)}}})},children:(0,o.tZ)(O.Z,{elementId:"taskChooseOrganization",mainIdentifierSx:v.fq,organization:a.organization})}):null},_=a=>{let t=(0,c.useCardState)(),{getOrganization:e}=(0,i.cL)(),[r,s]=(0,n.useState)(null),{userInvitations:d}=(0,i.eW)({userInvitations:m.AO.userInvitations});return r?(0,o.tZ)(f,{organization:r}):(0,o.tZ)(v.ij,{organizationData:a.publicOrganizationData,elementId:"taskChooseOrganization",elementDescriptor:l.descriptors.taskChooseOrganizationPreviewItem,children:(0,o.tZ)(v.De,{isLoading:t.isLoading,onClick:()=>t.runAsync(async()=>[await a.accept(),await e(a.publicOrganizationData.id)]).then(a=>{var t;let[e,o]=a;null==d||null==(t=d.setData)||t.call(d,a=>(0,m.Sz)(e,a,"negative")),s(o)}).catch(a=>(0,b.S3)(a,[],t.setError)),localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.action__invitationAccept")})})},w=(0,c.withCardStateProvider)(a=>{let t=(0,c.useCardState)(),{userSuggestions:e}=(0,i.eW)({userSuggestions:m.AO.userSuggestions});return(0,o.tZ)(v.ij,{organizationData:a.publicOrganizationData,elementId:"taskChooseOrganization",elementDescriptor:l.descriptors.taskChooseOrganizationPreviewItem,children:"accepted"===a.status?(0,o.tZ)(l.Text,{colorScheme:"secondary",localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.suggestionsAcceptedLabel")}):(0,o.tZ)(v.De,{onClick:()=>t.runAsync(a.accept).then(a=>{var t;return null==e||null==(t=e.setData)?void 0:t.call(e,t=>(0,m.Sz)(a,t))}).catch(a=>(0,b.S3)(a,[],t.setError)),isLoading:t.isLoading,localizationKey:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.action__suggestionsAccept")})})}),S=a=>{let{onCreateOrganizationClick:t}=a,{user:e}=(0,i.aF)();return(null==e?void 0:e.createOrganizationEnabled)?(0,o.tZ)(y.aU,{elementDescriptor:l.descriptors.taskChooseOrganizationCreateOrganizationActionButton,icon:Z.mm,label:(0,l.localizationKeys)("taskChooseOrganization.chooseOrganization.action__createOrganization"),onClick:t,sx:a=>({borderTopWidth:a.borderWidths.$normal,borderTopStyle:a.borderStyles.$solid,borderTopColor:a.colors.$borderAlpha100,padding:"".concat(a.space.$5," ").concat(a.space.$5)}),iconSx:a=>({width:a.sizes.$9,height:a.sizes.$6})}):null};e(50725),e(70332);var D=e(8181),K=e(70431),x=e(19460),$=e(68487),P=e(53412),A=e(7259),L=e(36788),I=e(30215);function F(a){let{organizationCreationDefaults:t}=a,e=T(null==t?void 0:t.advisory);return e?(0,o.tZ)(I.bZ,{colorScheme:"warning",children:(0,o.tZ)(l.Text,{colorScheme:"warning",localizationKey:e,variant:"caption"})}):null}let T=a=>a&&"organization_already_exists"===a.code?(0,l.localizationKeys)("taskChooseOrganization.alerts.organizationAlreadyExists",{organizationDomain:a.meta.organization_domain,organizationName:a.meta.organization_name}):null,B=a=>{var t,e,s,u,g,h,z,p;let v=(0,c.useCardState)(),{navigateOnSetActive:y}=(0,C.G)(),{redirectUrlComplete:O}=(0,C._)(),{createOrganization:k,isLoaded:f,setActive:_}=(0,i.eW)({userMemberships:m.AO.userMemberships}),{organizationSettings:w}=(0,r.useEnvironment)(),[S,I]=(0,n.useState)(),T=(0,L.Yp)("name",null!=(z=null==(e=a.organizationCreationDefaults)||null==(t=e.form)?void 0:t.name)?z:"",{type:"text",label:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldLabel__name"),placeholder:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldInputPlaceholder__name")}),B=(0,L.Yp)("slug",null!=(p=null==(u=a.organizationCreationDefaults)||null==(s=u.form)?void 0:s.slug)?p:"",{type:"text",label:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldLabel__slug"),placeholder:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formFieldInputPlaceholder__slug")}),E=!w.slug.disabled,R=async a=>{if(a.preventDefault(),f)try{let a={name:T.value};E&&(a.slug=B.value);let t=await k(a),e=X(t);await Promise.allSettled([e]),await _({organization:t,navigate:async a=>{let{session:t}=a;await (null==y?void 0:y({session:t,redirectUrlComplete:O}))}})}catch(a){(0,b.S3)(a,[T,B],v.setError)}},X=async a=>{if(S)await a.setLogo({file:S});else if(W){let t=await fetch(W),e=await t.blob(),o=new File([e],"logo",{type:e.type});await a.setLogo({file:o})}},N=a=>{B.setValue(a)},U=!T.value||!f,W=void 0===S?null==(h=a.organizationCreationDefaults)||null==(g=h.form)?void 0:g.logo:void 0;return(0,o.BX)(o.HY,{children:[(0,o.BX)(d.h.Root,{showLogo:!0,sx:a=>({padding:"".concat(a.space.$none," ").concat(a.space.$8)}),children:[(0,o.tZ)(d.h.Title,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.title")}),(0,o.tZ)(d.h.Subtitle,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.subtitle")})]}),(0,o.tZ)($.Y,{sx:a=>({padding:"".concat(a.space.$none," ").concat(a.space.$10," ").concat(a.space.$8)}),children:(0,o.BX)(K.l.Root,{onSubmit:R,children:[(0,o.tZ)(F,{organizationCreationDefaults:a.organizationCreationDefaults}),(0,o.tZ)(D.D,{organization:{name:T.value,imageUrl:null!=W?W:void 0},onAvatarChange:async a=>await I(a),onAvatarRemove:S||W?()=>(v.setIdle(),I(null)):null,showLoadingSpinner:!!W,avatarPreviewPlaceholder:(0,o.tZ)(P.h,{variant:"ghost","aria-label":"Upload organization logo",icon:(0,o.tZ)(l.Icon,{size:"md",icon:Z.gq,sx:a=>({color:a.colors.$colorMutedForeground,transitionDuration:a.transitionDuration.$controls})}),sx:a=>({width:a.sizes.$16,height:a.sizes.$16,borderRadius:a.radii.$md,borderWidth:a.borderWidths.$normal,borderStyle:a.borderStyles.$dashed,borderColor:a.colors.$borderAlpha200,backgroundColor:a.colors.$neutralAlpha50,":hover":{backgroundColor:a.colors.$neutralAlpha50,svg:{transform:"scale(1.2)"}}})})}),(0,o.tZ)(K.l.ControlRow,{elementId:T.id,children:(0,o.tZ)(K.l.PlainInput,{...T.props,onChange:a=>{T.setValue(a.target.value),N((0,A.q)(a.target.value))},isRequired:!0,autoFocus:!0,ignorePasswordManager:!0})}),E&&(0,o.tZ)(K.l.ControlRow,{elementId:B.id,children:(0,o.tZ)(K.l.PlainInput,{...B.props,onChange:a=>N(a.target.value),isRequired:!0,pattern:"^(?=.*[a-z0-9])[a-z0-9\\-]+$",ignorePasswordManager:!0})}),(0,o.BX)(x.K,{sx:()=>({flexDirection:"column"}),children:[(0,o.tZ)(K.l.SubmitButton,{block:!0,isDisabled:U,localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formButtonSubmit")}),a.onCancel&&(0,o.tZ)(K.l.ResetButton,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.createOrganization.formButtonReset"),onClick:a.onCancel})]})]})})]})},E=()=>{var a,t;let{signOut:e}=(0,i.cL)(),{user:n}=(0,i.aF)(),{session:c}=(0,i.kP)(),{otherSessions:d}=(0,g.j)({user:n}),{navigateAfterSignOut:u,navigateAfterMultiSessionSingleSignOutUrl:h}=(0,r.useSignOutContext)(),z=null!=(t=null==n||null==(a=n.primaryEmailAddress)?void 0:a.emailAddress)?t:null==n?void 0:n.username;return(0,o.tZ)(s.Z.Footer,{children:(0,o.BX)(s.Z.Action,{elementId:"signOut",gap:2,justify:"center",sx:()=>({width:"100%"}),children:[z&&(0,o.tZ)(s.Z.ActionText,{truncate:!0,localizationKey:(0,l.localizationKeys)("taskChooseOrganization.signOut.actionText",{identifier:z})}),(0,o.tZ)(s.Z.ActionLink,{sx:()=>({flexShrink:0}),onClick:()=>0===d.length?e(u):e(h,{sessionId:null==c?void 0:c.id}),localizationKey:(0,l.localizationKeys)("taskChooseOrganization.signOut.actionLink")})]})})},R=(0,c.withCardStateProvider)(a=>{let[t,e]=(0,n.useState)(a.initialFlow);return"create"===t?(0,o.tZ)(B,{onCancel:"choose"===a.initialFlow?()=>e("choose"):void 0,organizationCreationDefaults:a.organizationCreationDefaults}):(0,o.tZ)(k,{onCreateOrganizationClick:()=>e("create")})});function X(){return(0,o.tZ)(l.Flow.Root,{flow:"taskChooseOrganization",children:(0,o.tZ)(l.Flow.Part,{part:"organizationCreationDisabled",children:(0,o.BX)(s.Z.Root,{children:[(0,o.tZ)(s.Z.Content,{children:(0,o.BX)(d.h.Root,{showLogo:!0,children:[(0,o.tZ)(d.h.Title,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.organizationCreationDisabled.title")}),(0,o.tZ)(d.h.Subtitle,{localizationKey:(0,l.localizationKeys)("taskChooseOrganization.organizationCreationDisabled.subtitle")})]})}),(0,o.tZ)(E,{})]})})})}let N=(0,r.withCoreSessionSwitchGuard)((0,z.U)((0,c.withCardStateProvider)(()=>{var a;let{user:t}=(0,i.aF)(),{userMemberships:e,userSuggestions:n,userInvitations:c}=(0,h.H)(),{organizationSettings:d}=(0,r.useEnvironment)(),g=(0,u.ib)((null==(a=d.organizationCreationDefaults)?void 0:a.enabled)?null==t?void 0:t.getOrganizationCreationDefaults:void 0,"organization-creation-defaults"),z=(null==e?void 0:e.isLoading)||(null==c?void 0:c.isLoading)||(null==n?void 0:n.isLoading)||(null==g?void 0:g.isLoading),p=!!((null==e?void 0:e.count)||(null==c?void 0:c.count)||(null==n?void 0:n.count));return z||(null==t?void 0:t.createOrganizationEnabled)||p?(0,o.tZ)(l.Flow.Root,{flow:"taskChooseOrganization",children:(0,o.tZ)(l.Flow.Part,{part:"chooseOrganization",children:(0,o.BX)(s.Z.Root,{children:[(0,o.tZ)(s.Z.Content,{sx:a=>({padding:"".concat(a.space.$8," ").concat(a.space.$none," ").concat(a.space.$none),gap:a.space.$7}),children:z?(0,o.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:a=>({height:"100%",minHeight:a.sizes.$100}),children:(0,o.tZ)(l.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})}):(0,o.tZ)(R,{initialFlow:p?"choose":"create",organizationCreationDefaults:g.data})}),(0,o.tZ)(E,{})]})})}):(0,o.tZ)(X,{})}),"choose-organization"))},25135:function(a,t,e){e.d(t,{U:()=>r});var o=e(95274),i=e(96231),n=e(86988);let r=(a,t)=>{let e=a.displayName||a.name||"Component";a.displayName=e;let r=e=>{let r=(0,n.G)();return(0,i.me)(a,a=>{var e;return!(null==(e=a.session)?void 0:e.currentTask)||a.session.currentTask.key!==t&&!a.__internal_setActiveInProgress},a=>{var t;let{clerk:e}=a;return e.session?null!=(t=r.redirectUrlComplete)?t:e.buildAfterSignInUrl():e.buildSignInUrl()},o.q.cannotRenderComponentWhenTaskDoesNotExist)(e)};return r.displayName="withTaskGuard(".concat(e,")"),r}}}]);